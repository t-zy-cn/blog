import{encodeData as k,entries as v,Logger as ye,ensureEndingSlash as he,isModuleAvailable as ke,isDef as be,isPlainObject as C,keys as x,endsWith as M,deepAssign as T,fromEntries as O,isArray as $e,addViteSsrNoExternal as ve,addViteOptimizeDepsExclude as D,addViteSsrExternal as P,addViteOptimizeDepsInclude as I,addViteOptimizeDepsNeedsInterop as Pe,chainWebpack as we}from"@vuepress/helper";import{useSassPalettePlugin as Ce}from"@vuepress/plugin-sass-palette";import{hash as je,path as Se,getDirname as xe,colors as w,logger as Me}from"vuepress/utils";import{createConverter as _e}from"vuepress-shared/node";import{container as _}from"@mdit/plugin-container";import{uml as Oe}from"@mdit/plugin-uml";import{plantuml as De}from"@mdit/plugin-plantuml";import{demo as Ie}from"@mdit/plugin-demo";const z=e=>{_(e,{name:"chartjs",openRender:(t,n)=>{const r=t[n].info.trimStart().slice(7).trim(),s=`chartjs-${n}`;let o="{}",a="";for(let l=n;l<t.length;l++){const{type:i,content:f,info:u}=t[l];if(i==="container_chartjs_close")break;f&&(i==="fence"&&(u==="json"?(o=k(f),a="json"):(u==="js"||u==="javascript")&&(o=k(f),a="js")),t[l].type="chartjs_empty",t[l].hidden=!0)}return`<ChartJS id="${s}" config="${o}" ${r?`title="${encodeURIComponent(r)}" `:""}type="${a}">`},closeRender:()=>"</ChartJS>"})},F={useBabel:!1,jsLib:[],cssLib:[],codepenLayout:"left",codepenEditors:"101",babel:"https://unpkg.com/@babel/standalone/babel.min.js",vue:"https://unpkg.com/vue/dist/vue.global.prod.js",react:"https://unpkg.com/react/umd/react.production.min.js",reactDOM:"https://unpkg.com/react-dom/umd/react-dom.production.min.js"},E=e=>t=>{_(t,{name:e,openRender:(n,r)=>{const s=n[r].info.trimStart().slice(e.length).trim();let o="";const a={};for(let l=r;l<n.length;l++){const{type:i,content:f,info:u}=n[l],m=u?/^([^ :[{]+)/.exec(t.utils.unescapeAll(u).trim())?.[1]??"text":"";if(i===`container_${e}_close`)break;f&&i==="fence"&&(m==="json"?o=k(f):a[m]=f)}return`<CodeDemo id="code-demo-${r}" type="${e.split("-")[0]}"${s?` title="${encodeURIComponent(s)}"`:""}${o?` config="${o}"`:""} code="${k(JSON.stringify(a))}">
`},closeRender:()=>`</CodeDemo>
`})},J=E("normal-demo"),L=E("vue-demo"),V=E("react-demo"),G=(e,t)=>{const n=e[t],r=`echarts-${t}`,{content:s,info:o}=n,a=o.trim().split(":",2)[1];return`<ECharts id="${r}" config="${k(s)}"${a?` title="${encodeURIComponent(a)}"`:""}></ECharts>`},q=e=>{const{fence:t}=e.renderer.rules;e.renderer.rules.fence=(...n)=>{const[r,s]=n,{info:o}=r[s];return o.split(":",2)[0]==="echarts"?G(r,s):t(...n)},e.renderer.rules.echarts=G,_(e,{name:"echarts",openRender:(n,r)=>{const s=n[r].info.trimStart().slice(7).trim(),o=`echarts-${r}`;let a="{}",l=!1;for(let i=r;i<n.length;i++){const{type:f,content:u,info:m}=n[i];if(f==="container_echarts_close")break;u&&(f==="fence"&&(m==="json"?a=u:(m==="js"||m==="javascript")&&(a=u,l=!0)),n[i].type="echarts_empty",n[i].hidden=!0)}return`<ECharts id="${o}" config="${k(a)}"${s?` title="${encodeURIComponent(s)}"`:""}${l?' type="js"':""}>`},closeRender:()=>"</ECharts>"})},Re=["ant","pie","vue"],B=(e,t)=>{const n=e[t],r=`flowchart-${t}`,{content:s,info:o}=n,a=o.trim().split(":",2)[1];return`<FlowChart id="${r}" code="${k(s)}" preset="${Re.includes(a)?a:"vue"}"></FlowChart>`},K=e=>{const{fence:t}=e.renderer.rules;e.renderer.rules.fence=(...n)=>{const[r,s]=n,{info:o}=r[s],[a]=o.split(":",2);return a==="flow"||a==="flowchart"?B(r,s):t(...n)},e.renderer.rules.flowchart=B},R=e=>e.replace(/&/gu,"&amp;").replace(/</gu,"&lt;").replace(/>/gu,"&gt;").replace(/"/gu,"&quot;").replace(/'/gu,"&#39;"),W="@",Ee=["file","import","setting"],Ue=e=>(t,n,r,s)=>{let o=t.bMarks[n]+t.tShift[n],a=t.eMarks[n];if(t.src[o]!==":")return!1;let l=o+1;for(;l<=a&&t.src[l]===":";)l+=1;const i=l-o;if(i<3)return!1;const f=t.src.slice(o,l),u=t.src.slice(l,a),m=u.trimStart().split(" ",2)[0],y=u.trimStart().slice(e.length).trim();if(m.trim()!==e)return!1;if(s)return!0;let c=n,d=!1;for(;c<r&&(c+=1,o=t.bMarks[c]+t.tShift[c],a=t.eMarks[c],!(o<a&&t.sCount[c]<t.blkIndent));)if(t.src[o]===":"&&t.sCount[c]-t.blkIndent<4){for(l=o+1;l<=a&&t.src[l]===":";l++);if(l-o>=i&&(l=t.skipSpaces(l),l>=a)){d=!0;break}}const p=t.parentType,g=t.lineMax;t.parentType=e,t.lineMax=c-(d?1:0);const h=t.push(`${e}_open`,"template",1);h.markup=f,h.block=!0,h.info=y,h.map=[n,c-(d?1:0)],t.md.block.tokenize(t,n+1,c-(d?1:0));const S=t.push(`${e}_close`,"template",-1);return S.markup=t.src.slice(o,l),S.block=!0,t.parentType=p,t.lineMax=g,t.line=c+(d?1:0),!0},Ne=e=>(t,n,r,s)=>{let o=t.bMarks[n]+t.tShift[n],a=t.eMarks[n];const l=`${W}${e}`;if(t.src.charAt(o)!=="@")return!1;let i;for(i=0;i<l.length;i++)if(l[i]!==t.src[o+i])return!1;const f=t.src.slice(o,o+i),u=t.src.slice(o+i,a);if(s)return!0;let m=n,y=!1;for(;m<r&&(m+=1,o=t.bMarks[m]+t.tShift[m],a=t.eMarks[m],!(o<a&&t.sCount[m]<t.blkIndent));)if(t.src[o]===W&&t.sCount[m]<=t.sCount[n]){let h=!0;for(i=0;i<l.length;i++)if(l[i]!==t.src[o+i]){h=!1;break}if(h){y=!0,m-=1;break}}const c=t.parentType,d=t.lineMax;t.parentType=e,t.lineMax=m;const p=t.push(`${e}_open`,"template",1);p.block=!0,p.markup=f,p.info=u.trim(),p.map=[n,m],t.md.block.tokenize(t,n+1,m);const g=t.push(`${e}_close`,"template",-1);return g.block=!0,g.markup="",t.parentType=c,t.lineMax=d,t.line=m+(y?1:0),!0},H=e=>({key:e.key,title:e.title??"",files:encodeURIComponent(JSON.stringify(e.files)),settings:encodeURIComponent(JSON.stringify(e.settings))}),j=(e,{name:t="playground",component:n="Playground",propsGetter:r=H}={name:"playground",component:"Playground",propsGetter:H})=>{e.block.ruler.before("fence",t,Ue(t),{alt:["paragraph","reference","blockquote","list"]}),Ee.forEach(s=>{e.block.ruler.__rules__.find(({name:o})=>o===`at-${s}`)||e.block.ruler.before("fence",`at-${s}`,Ne(s),{alt:["paragraph","reference","blockquote","list"]})}),e.renderer.rules[`${t}_open`]=(s,o)=>{const{info:a}=s[o],l={key:je(`playground${o}-${a}`),title:encodeURIComponent(a),settings:{},files:{}};let i=null,f=!1;for(let m=o;m<s.length;m++){const{block:y,type:c,info:d,content:p}=s[m];if(y){if(c===`${t}_close`)break;if(c===`${t}_open`)continue;if(c==="file_open"){if(!d)continue;i=d}else if(c==="import_open")l.importMap=i=d||"import-map.json";else if(c==="setting_open")f=!0;else if(c==="file_close"||c==="import_close"||c==="setting_close"||!p){s[m].type=`${t}_empty`,s[m].hidden=!0,c==="setting_close"&&(f=!1);continue}f?c==="fence"&&d==="json"&&(l.settings=JSON.parse(p.trim())):c==="fence"&&i&&(l.files[i]={ext:d,content:p}),s[m].type=`${t}_empty`,s[m].hidden=!0}}const u=r(l);return`<${n} ${v(u).map(([m,y])=>`${m}="${R(y)}"`).join(" ")}>
`},e.renderer.rules[`${t}_close`]=()=>`</${n}>
`},Ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",Te=(e,t,n)=>{let r,s,o,a={},l={},i="",f="",u="",m=2,y=3,c=2,d=[],p=0,g=0;for(o=0;o<e.length;o+=1)if(i=e.charAt(o),Object.prototype.hasOwnProperty.call(a,i)||(a[i]=y++,l[i]=!0),f=u+i,Object.prototype.hasOwnProperty.call(a,f))u=f;else{if(Object.prototype.hasOwnProperty.call(l,u)){if(u.charCodeAt(0)<256){for(r=0;r<c;r++)p<<=1,g==t-1?(g=0,d.push(n(p)),p=0):g++;for(s=u.charCodeAt(0),r=0;r<8;r++)p=p<<1|1&s,g==t-1?(g=0,d.push(n(p)),p=0):g++,s>>=1}else{for(s=1,r=0;r<c;r++)p=p<<1|s,g==t-1?(g=0,d.push(n(p)),p=0):g++,s=0;for(s=f.charCodeAt(0),r=0;r<16;r++)p=p<<1|1&s,g==t-1?(g=0,d.push(n(p)),p=0):g++,s>>=1}--m==0&&(m=Math.pow(2,c),c++),delete l[u]}else for(s=a[u],r=0;r<c;r++)p=p<<1|1&s,g==t-1?(g=0,d.push(n(p)),p=0):g++,s>>=1;--m==0&&(m=Math.pow(2,c),c++),a[f]=y++,u=String(i)}if(u!==""){if(Object.prototype.hasOwnProperty.call(l,u)){if(u.charCodeAt(0)<256){for(r=0;r<c;r++)p<<=1,g==t-1?(g=0,d.push(n(p)),p=0):g++;for(s=u.charCodeAt(0),r=0;r<8;r++)p=p<<1|1&s,g==t-1?(g=0,d.push(n(p)),p=0):g++,s>>=1}else{for(s=1,r=0;r<c;r++)p=p<<1|s,g==t-1?(g=0,d.push(n(p)),p=0):g++,s=0;for(s=u.charCodeAt(0),r=0;r<16;r++)p=p<<1|1&s,g==t-1?(g=0,d.push(n(p)),p=0):g++,s>>=1}--m==0&&(m=Math.pow(2,c),c++),delete l[u]}else for(s=a[u],r=0;r<c;r++)p=p<<1|1&s,g==t-1?(g=0,d.push(n(p)),p=0):g++,s>>=1;--m==0&&(m=Math.pow(2,c),c++)}for(s=2,r=0;r<c;r++)p=p<<1|1&s,g==t-1?(g=0,d.push(n(p)),p=0):g++,s>>=1;for(;;){if(p<<=1,g==t-1){d.push(n(p));break}g++}return d.join("")},Y=e=>Te(e,6,t=>Ae.charAt(t)),ze=[{name:"help",type:"boolean"},{name:"help",type:"boolean"},{name:"watch",type:"boolean"},{name:"preserveWatchOutput",type:"boolean"},{name:"listFiles",type:"boolean"},{name:"explainFiles",type:"boolean"},{name:"listEmittedFiles",type:"boolean"},{name:"pretty",type:"boolean"},{name:"traceResolution",type:"boolean"},{name:"diagnostics",type:"boolean"},{name:"extendedDiagnostics",type:"boolean"},{name:"generateCpuProfile",type:"string"},{name:"generateTrace",type:"string"},{name:"incremental",type:"boolean"},{name:"declaration",type:"boolean"},{name:"declarationMap",type:"boolean"},{name:"emitDeclarationOnly",type:"boolean"},{name:"sourceMap",type:"boolean"},{name:"inlineSourceMap",type:"boolean"},{name:"noCheck",type:"boolean"},{name:"noEmit",type:"boolean"},{name:"assumeChangesOnlyAffectDirectDependencies",type:"boolean"},{name:"locale",type:"string"},{name:"all",type:"boolean"},{name:"version",type:"boolean"},{name:"init",type:"boolean"},{name:"project",type:"string"},{name:"showConfig",type:"boolean"},{name:"listFilesOnly",type:"boolean"},{name:"target",type:{es3:0,es5:1,es6:2,es2015:2,es2016:3,es2017:4,es2018:5,es2019:6,es2020:7,es2021:8,es2022:9,es2023:10,es2024:11,esnext:99}},{name:"module",type:{none:0,commonjs:1,amd:2,system:4,umd:3,es6:5,es2015:5,es2020:6,es2022:7,esnext:99,node16:100,node18:101,nodenext:199,preserve:200}},{name:"lib",type:"list"},{name:"allowJs",type:"boolean"},{name:"checkJs",type:"boolean"},{name:"jsx",type:{preserve:1,"react-native":3,react:2,"react-jsx":4,"react-jsxdev":5}},{name:"outFile",type:"string"},{name:"outDir",type:"string"},{name:"rootDir",type:"string"},{name:"composite",type:"boolean"},{name:"tsBuildInfoFile",type:"string"},{name:"removeComments",type:"boolean"},{name:"importHelpers",type:"boolean"},{name:"importsNotUsedAsValues",type:{remove:0,preserve:1,error:2}},{name:"downlevelIteration",type:"boolean"},{name:"isolatedModules",type:"boolean"},{name:"verbatimModuleSyntax",type:"boolean"},{name:"isolatedDeclarations",type:"boolean"},{name:"erasableSyntaxOnly",type:"boolean"},{name:"libReplacement",type:"boolean"},{name:"strict",type:"boolean"},{name:"noImplicitAny",type:"boolean"},{name:"strictNullChecks",type:"boolean"},{name:"strictFunctionTypes",type:"boolean"},{name:"strictBindCallApply",type:"boolean"},{name:"strictPropertyInitialization",type:"boolean"},{name:"strictBuiltinIteratorReturn",type:"boolean"},{name:"noImplicitThis",type:"boolean"},{name:"useUnknownInCatchVariables",type:"boolean"},{name:"alwaysStrict",type:"boolean"},{name:"noUnusedLocals",type:"boolean"},{name:"noUnusedParameters",type:"boolean"},{name:"exactOptionalPropertyTypes",type:"boolean"},{name:"noImplicitReturns",type:"boolean"},{name:"noFallthroughCasesInSwitch",type:"boolean"},{name:"noUncheckedIndexedAccess",type:"boolean"},{name:"noImplicitOverride",type:"boolean"},{name:"noPropertyAccessFromIndexSignature",type:"boolean"},{name:"moduleResolution",type:{node10:2,node:2,classic:1,node16:3,nodenext:99,bundler:100}},{name:"baseUrl",type:"string"},{name:"paths",type:"object"},{name:"rootDirs",type:"list"},{name:"typeRoots",type:"list"},{name:"types",type:"list"},{name:"allowSyntheticDefaultImports",type:"boolean"},{name:"esModuleInterop",type:"boolean"},{name:"preserveSymlinks",type:"boolean"},{name:"allowUmdGlobalAccess",type:"boolean"},{name:"moduleSuffixes",type:"list"},{name:"allowImportingTsExtensions",type:"boolean"},{name:"rewriteRelativeImportExtensions",type:"boolean"},{name:"resolvePackageJsonExports",type:"boolean"},{name:"resolvePackageJsonImports",type:"boolean"},{name:"customConditions",type:"list"},{name:"noUncheckedSideEffectImports",type:"boolean"},{name:"sourceRoot",type:"string"},{name:"mapRoot",type:"string"},{name:"inlineSources",type:"boolean"},{name:"experimentalDecorators",type:"boolean"},{name:"emitDecoratorMetadata",type:"boolean"},{name:"jsxFactory",type:"string"},{name:"jsxFragmentFactory",type:"string"},{name:"jsxImportSource",type:"string"},{name:"resolveJsonModule",type:"boolean"},{name:"allowArbitraryExtensions",type:"boolean"},{name:"out",type:"string"},{name:"reactNamespace",type:"string"},{name:"skipDefaultLibCheck",type:"boolean"},{name:"charset",type:"string"},{name:"emitBOM",type:"boolean"},{name:"newLine",type:{crlf:0,lf:1}},{name:"noErrorTruncation",type:"boolean"},{name:"noLib",type:"boolean"},{name:"noResolve",type:"boolean"},{name:"stripInternal",type:"boolean"},{name:"disableSizeLimit",type:"boolean"},{name:"disableSourceOfProjectReferenceRedirect",type:"boolean"},{name:"disableSolutionSearching",type:"boolean"},{name:"disableReferencedProjectLoad",type:"boolean"},{name:"noImplicitUseStrict",type:"boolean"},{name:"noEmitHelpers",type:"boolean"},{name:"noEmitOnError",type:"boolean"},{name:"preserveConstEnums",type:"boolean"},{name:"declarationDir",type:"string"},{name:"skipLibCheck",type:"boolean"},{name:"allowUnusedLabels",type:"boolean"},{name:"allowUnreachableCode",type:"boolean"},{name:"suppressExcessPropertyErrors",type:"boolean"},{name:"suppressImplicitAnyIndexErrors",type:"boolean"},{name:"forceConsistentCasingInFileNames",type:"boolean"},{name:"maxNodeModuleJsDepth",type:"number"},{name:"noStrictGenericChecks",type:"boolean"},{name:"useDefineForClassFields",type:"boolean"},{name:"preserveValueImports",type:"boolean"},{name:"keyofStringsOnly",type:"boolean"},{name:"plugins",type:"list"},{name:"moduleDetection",type:{auto:2,legacy:1,force:3}},{name:"ignoreDeprecations",type:"string"}],Fe=xe(import.meta.url),Q="vuepress-plugin-md-enhance",$=new ye(Q),b=he(Se.resolve(Fe,"../client")),Je=(e,t=!0)=>{const n=ke(e,import.meta);return t&&!n&&$.error(`Package ${e} is not installed, please install it manually!`),n},X=(e,t={})=>{const n=`#code/${Y(e)}`,r=v(t).map(([s,o])=>{const a=ze.find(i=>i.name===s);if(!a||o===null||!be(o))return"";const{type:l}=a;return C(l)?l[o]?.toString()??"":`${s}=${encodeURIComponent(o)}`}).filter(s=>s.length).join("&");return`${r?`?${r}`:""}${n}`},Z=({service:e="https://www.typescriptlang.org/play",...t}={})=>({name:"playground#ts",propsGetter:({title:n="",files:r,settings:s})=>{const o=x(r).filter(l=>M(l,".ts"));o.length!==1&&$.error("TS playground only support 1 ts file");const a=`${e}${X(r[o[0]].content,T({},s,t))}`;return{title:n,link:encodeURIComponent(a)}}}),Le=["html","js","ts","vue","jsx","tsx","json"],ee="https://sfc.vuejs.org/vue.runtime.esm-browser.js",te="https://sfc.vuejs.org/server-renderer.esm-browser.js",ne=(e={})=>({name:"playground#vue",propsGetter:t=>{const{title:n="",files:r,settings:s}=t,o={service:"https://sfc.vuejs.org/",dev:!1,ssr:!1,...e,...s},a=O(v(r).filter(([,{ext:l}])=>Le.includes(l)).map(([l,{content:i}])=>{if(l==="import-map.json"){const f=JSON.parse(i);return[l,JSON.stringify(T({imports:{vue:ee,...o.ssr?{"vue/server-renderer":te}:{}}},f),null,2)]}return[l,i]}));return o.ssr&&!a["import-map.json"]&&(a["import-map.json"]=JSON.stringify({imports:{vue:ee,"vue/server-renderer":te}},null,2)),{title:n,link:encodeURIComponent(`${o.service}#${o.dev?"__DEV__":""}${o.ssr?"__SSR__":""}${Buffer.from(JSON.stringify(a)).toString("base64")}`)}}}),U=(e,t,n="&")=>t?`${n}${e}=${Y(t)}`:"",oe=(e,t,n,r)=>{const s=`/${U("html",t,"?")}${U("config",r)}${U("css",n)}`;return`${e}${s}`},se=({service:e="https://unocss.dev/play"}={})=>({name:"playground#unocss",propsGetter:({title:t="",files:n})=>{const r=x(n).filter(i=>M(i,".html")),s=x(n).filter(i=>M(i,".css")),o=x(n).filter(i=>M(i,".js")||M(i,".ts"));(r.length>1||s.length>1||o.length>1)&&$.error("UnoCSS playground only support 1 html/css/config file");const a=i=>i.length===1?n[i[0]].content:"",l=oe(e,a(r),a(s),a(o));return{title:t,link:encodeURIComponent(l)}}}),ae=e=>{e.use(j,{name:"kotlin-playground",component:"KotlinPlayground",propsGetter:({title:t="",key:n,files:r,settings:s})=>({title:t,key:n,settings:encodeURIComponent(JSON.stringify(s)),files:k(JSON.stringify(v(r).map(([,{content:o}])=>o)))})})},re=(e,t)=>{const n=e[t],r=`markmap-${t}`,{content:s}=n;return`<MarkMap id="${r}" content="${k(s)}"></MarkMap>`},ie=e=>{const{fence:t}=e.renderer.rules;e.renderer.rules.fence=(...n)=>{const[r,s]=n,{info:o}=r[s],[a]=o.split(":",2);return a==="markmap"?re(r,s):t(...n)},e.renderer.rules.markmap=re},Ve=(e,t)=>`<Mermaid id="mermaid-${t}" code="${k(e[t].content)}"></Mermaid>`,le=({diagram:e="mermaid",content:t,title:n="",indent:r=e!=="mermaid"})=>{const[,s,o]=/^\s*---\n([^]*?)\n---\n\n([\s\S]*)\s*$/m.exec(t)??[null,"",t],a=(!n||/^title:\s*(.*)/m.test(s)?s:`title: ${n}
${s}`).trim();return`${a?`---
${a}
---

`:""}${e==="mermaid"?"":`${e}
`}${r?o.split(`
`).map(l=>l?`  ${l}`:"").join(`
`):o}`},pe=(e,t)=>`<Mermaid id="mermaid-${t}" code="${k(le(e))}"${e.title?` title="${k(e.title)}"`:""}></Mermaid>`,N={class:["classDiagram"],c4c:["C4Context"],er:["erDiagram"],gantt:[""],"git-graph":["gitGraph"],journey:[""],mindmap:[""],kanban:[""],pie:[""],quadrant:["quadrantChart"],requirement:["requirementDiagram"],sequence:["sequenceDiagram"],state:["stateDiagram-v2"],timeline:[""],architecture:["architecture-beta"],block:["block-beta",!1],packet:["packet-beta",!1],sankey:["sankey-beta",!1],xy:["xychart-beta",!1],radar:["radar-beta"]},me=e=>{const{fence:t}=e.renderer.rules;e.renderer.rules.fence=(...n)=>{const[r,s]=n,{content:o,info:a}=r[s],l=a.trim();if(l==="mermaid")return pe({content:o,indent:!1},s);const[i,...f]=l.split(" ");return i in N?pe({diagram:N[i][0]||i,title:f.join(" "),content:o,indent:N[i][1]??!0},s):t(...n)},e.renderer.rules.mermaid=Ve},A=(e,t=["chronology","gantt","json","latex","math","mindmap","regex","salt","uml","wbs","yaml"].map(n=>({name:n})))=>{t.forEach(n=>{e.use(De,n)})},Ge=["html","js","ts","vue","jsx","tsx","json"],qe=e=>Buffer.from(JSON.stringify(O(v(e).filter(([,{ext:t}])=>Ge.includes(t)).map(([t,{content:n}])=>[t,n])))).toString("base64"),ce=e=>{e.use(j,{name:"vue-playground",component:"VuePlayground",propsGetter:({title:t="",key:n,files:r,settings:s})=>({title:t,key:n,settings:encodeURIComponent(JSON.stringify(s)),files:encodeURIComponent(qe(r))})})},Be=e=>JSON.stringify(O(v(e).map(([t,n])=>[t,typeof n=="string"||n.active||n.hidden||n.readOnly?n:n.code]))),de=e=>{const t=/.*(?<!\\)\[([^}]*)\].*/.exec(e);if(t?.[1]){const n=t[1].split(" ");return O(n.filter(r=>r.trim().length>0).map(r=>{const[s,o=""]=r.trim().split("=",2);return[s,o]}))}return{}},ue="@",Ke=["file","options","setup"],We=e=>({title:e.title??"",template:e.template??"",files:k(Be(e.files)),options:k(JSON.stringify(e.options??{})),customSetup:k(JSON.stringify(e.customSetup??{}))}),fe=e=>new Function(`return ${e};`)(),He=(e,t,n,r)=>{let s=e.bMarks[t]+e.tShift[t],o=e.eMarks[t];if(e.src[s]!==":")return!1;let a=s+1;for(;a<=o&&e.src[a]===":";)a+=1;const l=a-s;if(l<3)return!1;const i=e.src.slice(s,a),f=e.src.slice(a,o).trim(),u=f.indexOf(" ");let m="",y="";if(u>0?(m=f.substring(0,u),y=f.substring(u+1).replace(/(?<!\\)\[([^}]*)\]/g,"")):m=f,!m.startsWith("sandpack"))return!1;if(r)return!0;let c=t,d=!1;for(;c<n&&(c+=1,s=e.bMarks[c]+e.tShift[c],o=e.eMarks[c],!(s<o&&e.sCount[c]<e.blkIndent));)if(e.src[s]===":"&&e.sCount[c]-e.blkIndent<4){for(a=s+1;a<=o&&e.src[a]===":";a++);if(a-s>=l&&(a=e.skipSpaces(a),a>=o)){d=!0;break}}const p=e.parentType,g=e.lineMax;e.parentType="sandpack",e.lineMax=c-(d?1:0);const h=e.push("sandpack_open","template",1);h.markup=i,h.content=f,h.block=!0,h.info=y,h.map=[t,c-(d?1:0)],e.md.block.tokenize(e,t+1,c-(d?1:0));const S=e.push("sandpack_close","template",-1);return S.markup=e.src.slice(s,a),S.block=!0,e.parentType=p,e.lineMax=g,e.line=c+(d?1:0),!0},Ye=e=>(t,n,r,s)=>{let o=t.bMarks[n]+t.tShift[n],a=t.eMarks[n];const l=`${ue}${e}`;if(t.src.charAt(o)!=="@")return!1;let i;for(i=0;i<l.length;i++)if(l[i]!==t.src[o+i])return!1;const f=t.src.slice(o,o+i),u=t.src.slice(o+i,a);if(s)return!0;let m=n,y=!1;for(;m<r&&(m+=1,o=t.bMarks[m]+t.tShift[m],a=t.eMarks[m],!(o<a&&t.sCount[m]<t.blkIndent));)if(t.src[o]===ue&&t.sCount[m]<=t.sCount[n]){let h=!0;for(i=0;i<l.length;i++)if(l[i]!==t.src[o+i]){h=!1;break}if(h){y=!0,m-=1;break}}const c=t.parentType,d=t.lineMax;t.parentType=e,t.lineMax=m;const p=t.push(`${e}_open`,"template",1);p.block=!0,p.markup=f,p.info=u.trim(),p.map=[n,m],t.md.block.tokenize(t,n+1,m);const g=t.push(`${e}_close`,"template",-1);return g.block=!0,g.markup="",t.parentType=c,t.lineMax=d,t.line=m+(y?1:0),!0},ge=e=>{e.block.ruler.before("fence","sandpack",He,{alt:["paragraph","reference","blockquote","list"]}),Ke.forEach(t=>{e.block.ruler.__rules__.find(({name:n})=>n===`at-${t}`)||e.block.ruler.before("fence",`at-${t}`,Ye(t),{alt:["paragraph","reference","blockquote","list"]})}),e.renderer.rules.sandpack_open=(t,n)=>{const{content:r,info:s}=t[n],o=de(r),a={title:encodeURIComponent(s),files:{},options:{},customSetup:{}},l=r.split(" ",2)[0].trim().split("#");l.length>1&&(a.template=l[1]);let i=null,f=!1,u=!1;for(let y=n;y<t.length;y++){const{block:c,type:d,info:p,content:g}=t[y];if(c){if(d==="sandpack_close")break;if(d==="sandpack_open")continue;if(d==="file_open"){if(!p)continue;i=p.trim().split(" ")[0];const h=de(p);a.files[i]={code:"",active:"active"in h,hidden:"hidden"in h,readOnly:"readOnly"in h}}else(d==="file_close"||d==="setup_open"||d==="options_open")&&(i=null);if(d==="setup_open"?u=!0:d==="setup_close"?u=!1:d==="options_open"?f=!0:d==="options_close"&&(f=!1),d==="file_close"||d==="setup_close"||d==="options_close"||!g){t[y].type="sandpack_empty",t[y].hidden=!0;continue}f&&(d==="fence"&&(p==="js"||p==="javascript")&&(a.options=fe(g.trim())),f=!1),u&&(d==="fence"&&(p==="js"||p==="javascript")&&(a.customSetup=fe(g.trim())),u=!1),d==="fence"&&i&&(a.files[i].code=g),t[y].type="sandpack_empty",t[y].hidden=!0}}const m=We(a);return`<SandPack ${x(o).length?`${v(o).map(([y,c])=>c?`${y}="${R(c)}"`:y).join(" ")} `:""}${v(m).map(([y,c])=>c?`${y}="${R(c)}"`:null).filter(Boolean).join(" ")}>
`},e.renderer.rules.sandpack_close=()=>`</SandPack>
`},Qe=e=>{_(e,{name:"chart",openRender:(t,n,r,s)=>{$.warn(`chart container is deprecated, use chartjs container instead${s.filePathRelative?` found in ${s.filePathRelative}`:""}.`);const o=t[n].info.trimStart().slice(5).trim(),a=`chart-${n}`;let l="{}",i="";for(let f=n;f<t.length;f++){const{type:u,content:m,info:y}=t[f];if(u==="container_chart_close")break;m&&(u==="fence"&&(y==="json"?(l=k(m),i="json"):(y==="js"||y==="javascript")&&(l=k(m),i="js")),t[f].type="chart_empty",t[f].hidden=!0)}return`<ChartJS id="${a}" config="${l}" ${o?`title="${encodeURIComponent(o)}" `:""}type="${i}">`},closeRender:()=>"</ChartJS>"})},Xe=e=>{const{deprecatedLogger:t,droppedLogger:n}=_e("md-enhance");t({options:e,old:"chart",new:"chartjs"}),n({options:e,old:"enableAll",msg:"Please manually enable the features you need."}),n({options:e,old:"imageFix",msg:"This option is no longer needed."}),n({options:e,old:"lineNumbers",msg:"Please use lineNumbers option in @vuepress/plugin-prismjs or @vuepress/plugin-shiki !"}),n({options:e,old:"alert",msg:"Please use alert option in @vuepress/plugin-markdown-hint instead."}),n({options:e,old:"container",msg:"Please use hint option in @vuepress/plugin-markdown-hint instead."}),n({options:e,old:"hint",msg:"Please use hint option in @vuepress/plugin-markdown-hint instead."}),n({options:e,old:"mdImport",msg:"Please use @vuepress/plugin-markdown-include instead."}),n({options:e,old:"include",msg:"Please use @vuepress/plugin-markdown-include instead."}),n({options:e,old:"imageTitle",msg:"Please use figure option in @vuepress/plugin-markdown-image instead."}),n({options:e,old:"figure",msg:"Please use figure option in @vuepress/plugin-markdown-image instead."}),n({options:e,old:"imageMark",msg:"Please use mark option in @vuepress/plugin-markdown-image instead."}),n({options:e,old:"imgMark",msg:"Please use mark option in @vuepress/plugin-markdown-image instead."}),n({options:e,old:"imgSize",msg:"Please use size option in @vuepress/plugin-markdown-image instead."}),n({options:e,old:"imageSize",msg:"Please use size option in @vuepress/plugin-markdown-image instead."}),n({options:e,old:"lazyload",msg:"Please use lazyload option in @vuepress/plugin-markdown-image instead."}),n({options:e,old:"imageLazyload",msg:"Please use lazyload option in @vuepress/plugin-markdown-image instead."}),n({options:e,old:"imgLazyload",msg:"Please use lazyload option in @vuepress/plugin-markdown-image instead."}),n({options:e,old:"obsidianImgSize",msg:"Please use obsidianSize option in @vuepress/plugin-markdown-image instead."}),n({options:e,old:"linkCheck",msg:"Please use @vuepress/plugin-links-check instead."}),n({options:e,old:"checkLinks",msg:"Please use @vuepress/plugin-links-check instead."}),n({options:e,old:"tex",msg:"Please use @vuepress/plugin-markdown-math instead."}),n({options:e,old:"katex",msg:"Please use @vuepress/plugin-markdown-math instead."}),n({options:e,old:"mathjax",msg:"Please use @vuepress/plugin-markdown-math instead."}),n({options:e,old:"revealjs",msg:"Please use @vuepress/plugin-revealjs instead."}),n({options:e,old:"revealJs",msg:"Please use @vuepress/plugin-revealjs instead."}),n({options:e,old:"presentation",msg:"Please use @vuepress/plugin-revealjs instead."}),n({options:e,old:"codegroup",msg:"Please use codeTabs option in @vuepress/plugin-markdown-tab instead."}),n({options:e,old:"codetabs",msg:"Please use codeTabs option in @vuepress/plugin-markdown-tab instead."}),n({options:e,old:"tabs",msg:"Please use tabs option in @vuepress/plugin-markdown-tab instead."}),n({options:e,old:"vpre",msg:"Please use vPre option in @vuepress/plugin-markdown-ext instead."}),n({options:e,old:"vPre",msg:"Please use vPre option in @vuepress/plugin-markdown-ext instead."}),n({options:e,old:"breaks",msg:"Please use breaks option in @vuepress/plugin-markdown-ext instead."}),n({options:e,old:"linkify",msg:"Please use linkify option in @vuepress/plugin-markdown-ext instead."}),n({options:e,old:"gfm",msg:"Please use gfm option in @vuepress/plugin-markdown-ext instead."}),n({options:e,old:"footnote",msg:"Please use footnote option in @vuepress/plugin-markdown-ext instead."}),n({options:e,old:"tasklist",msg:"Please use tasklist option in @vuepress/plugin-markdown-ext instead."}),n({options:e,old:"component",msg:"Please use component option in @vuepress/plugin-markdown-ext instead."}),n({options:e,old:"align",msg:"Please use align option in @vuepress/plugin-markdown-stylize instead."}),n({options:e,old:"attrs",msg:"Please use attrs option in @vuepress/plugin-markdown-stylize instead."}),n({options:e,old:"mark",msg:"Please use mark option in @vuepress/plugin-markdown-stylize instead."}),n({options:e,old:"spoiler",msg:"Please use spoiler option in @vuepress/plugin-markdown-stylize instead."}),n({options:e,old:"sub",msg:"Please use sub option in @vuepress/plugin-markdown-stylize instead."}),n({options:e,old:"sup",msg:"Please use sup option in @vuepress/plugin-markdown-stylize instead."}),n({options:e,old:"stylize",msg:"Please use custom option in @vuepress/plugin-markdown-stylize instead."}),e.card&&$.error(`${w.magenta("card")} is deprecated, please import  ${w.magenta("VPCard")} from "vuepress-plugin-components" and use it instead.`),C(e.mermaid)&&($.error(`Customizing mermaid with option ${w.magenta("mermaid")} is no longer supported, please import and use ${w.magenta("defineMermaidConfig")} from ${w.magenta("vuepress-plugin-md-enhance/client")} instead.`),e.mermaid=!0),C(e.vuePlayground)&&($.error(`Customizing @vue/repl with option ${w.magenta("vuePlayground")} is no longer supported, please import and use ${w.magenta("defineVuePlaygroundConfig")} from ${w.magenta("vuepress-plugin-md-enhance/client")} instead.`),e.vuePlayground=!0)},Ze=e=>{e.use(_,{name:"demo",openRender:(t,n)=>{$.warn("demo container is deprecated, you should use normal-demo, react-demo and vue-demo container instead.");const{info:r}=t[n],s=/\[(.*)\]/u.exec(r),o=/^ demo\s*(?:\[.*?\])?\s*(.*)\s*$/u.exec(r);let a="";const l={};for(let i=n;i<t.length;i++){const{type:f,content:u,info:m}=t[i],y=m?/^([^ :[{]+)/.exec(e.utils.unescapeAll(m).trim())?.[1]??"text":"";if(f==="container_demo_close")break;u&&f==="fence"&&(y==="json"?a=k(u):l[y]=u)}return`
<CodeDemo id="code-demo-${n}" type="${s?.[1]??"normal"}"${o?` title="${encodeURIComponent(o[1])}"`:""}${a?` config="${a}"`:""} code="${k(JSON.stringify(l))}">
`},closeRender:()=>"</CodeDemo>"})},et=e=>{e.use(Ie,{name:"md-demo",openRender:(t,n)=>($.warn("md-demo container is deprecated, you should use preview container instead."),`<MdDemo title="${R(t[n].info)}" id="md-demo-${n}">
`),codeRender:(t,n,r,s,o)=>`<template #code>
${o.rules.fence(t,n,r,s,o)}</template>
`,contentOpenRender:()=>`<template #default>
`,contentCloseRender:()=>`</template>
`,closeRender:()=>`</MdDemo>
`})},tt=e=>{Oe(e,{name:"flowchart",open:"flowstart",close:"flowend",render:(t,n)=>{Me.warn('"@flowstart ... @flowend" is deprecated, you should use ```flow ... ``` instead.');const r=t[n],s=`flowchart-${n}`,{content:o,info:a}=r;return`<FlowChart id="${s}" code="${k(o)}" preset="${a.trim()||"vue"}"></FlowChart>`}})},nt=async(e,t,n,r=!1)=>{const s=new Set,o=new Set;return n.chartjs&&(s.add(`import ChartJS from "${b}components/ChartJS.js";`),o.add('app.component("ChartJS", ChartJS)')),t.demo&&(s.add(`import CodeDemo from "${b}components/CodeDemo.js";`),o.add('app.component("CodeDemo", CodeDemo);'),r&&(s.add(`import MdDemo from "${b}components/MdDemo.js";`),o.add('app.component("MdDemo", MdDemo);'))),n.echarts&&(s.add(`import ECharts from "${b}components/ECharts.js";`),o.add('app.component("ECharts", ECharts);')),n.flowchart&&(s.add(`import FlowChart from "${b}components/FlowChart.js";`),o.add('app.component("FlowChart", FlowChart);')),n.kotlinPlayground&&(s.add(`import KotlinPlayground from "${b}components/KotlinPlayground.js";`),o.add('app.component("KotlinPlayground", KotlinPlayground);')),n.markmap&&(s.add(`import MarkMap from "${b}components/MarkMap.js";`),o.add('app.component("MarkMap", MarkMap);')),n.mermaid&&(s.add(`import Mermaid from "${b}components/Mermaid.js";`),o.add('app.component("Mermaid", Mermaid);')),t.playground&&(s.add(`import Playground from "${b}components/Playground.js";`),o.add('app.component("Playground", Playground);')),n.sandpack&&(s.add(`import SandPack from "${b}components/SandPack.js";`),o.add('app.component("SandPack", SandPack);')),n.vuePlayground&&(s.add(`import VuePlayground from "${b}components/VuePlayground.js";`),o.add('app.component("VuePlayground", VuePlayground);')),e.writeTemp("md-enhance/config.js",`${Array.from(s.values()).join(`
`)}

export default {
  enhance: ({ app }) => {
${Array.from(o.values()).map(a=>a.split(`
`).map(l=>`    ${l}`)).flat().join(`
`)}
  },
};
`)},ot=(e={},t=!0)=>n=>{t&&Xe(e),n.env.isDebug&&$.info("Options:",e);const r=(o,a=[])=>!!e[o]&&a.every(l=>Je(l,!!e[o])),s={chartjs:r("chartjs",["chart.js"]),echarts:r("echarts",["echarts"]),flowchart:r("flowchart",["flowchart.ts"]),mark:r("mark"),markmap:r("markmap",["markmap-lib","markmap-toolbar","markmap-view"]),mermaid:r("mermaid",["mermaid"]),kotlinPlayground:r("kotlinPlayground",["kotlin-playground"]),sandpack:r("sandpack",["sandpack-vue3"]),vuePlayground:r("vuePlayground",["@vue/repl"])};return Ce(n,{id:"hope"}),{name:Q,define:()=>({CODE_DEMO_OPTIONS:{...F,...C(e.demo)?e.demo:{}},VUE_PLAYGROUND_MONACO:C(e.vuePlayground)&&e.vuePlayground.editor==="monaco"}),extendsBundlerOptions:(o,a)=>{ve(o,a,["@vuepress/helper","fflate","vuepress-shared"]),s.chartjs&&(D(o,a,"chart.js/auto/auto.mjs"),P(o,a,"chart.js")),s.echarts&&(D(o,a,"echarts"),P(o,a,"echarts")),s.flowchart&&(D(o,a,"flowchart.ts"),P(o,a,"flowchart.ts")),s.markmap&&(I(o,a,["markmap-lib","markmap-toolbar","markmap-view"]),P(o,a,["markmap-lib","markmap-toolbar","markmap-view"])),s.mermaid&&(D(o,a,"mermaid/dist/mermaid.esm.min.mjs"),P(o,a,"mermaid")),s.kotlinPlayground&&(I(o,a,"kotlin-playground"),Pe(o,a,"kotlin-playground"),P(o,a,"kotlin-playground")),s.sandpack&&(I(o,a,"sandpack-vue3"),P(o,a,"sandpack-vue3")),s.vuePlayground&&(I(o,a,"@vue/repl"),P(o,a,"@vue/repl"),we(o,a,l=>{l.resolve.set("conditionNames",["browser","import","module"]),l.module.set("exprContextCritical",!1),l.module.set("unknownContextCritical",!1)}))},extendsMarkdown:o=>{if(s.flowchart&&(o.use(K),t&&o.use(tt)),s.chartjs&&(o.use(z),t&&o.use(Qe)),s.echarts&&o.use(q),$e(e.plantuml)?o.use(A,e.plantuml):e.plantuml&&o.use(A),e.demo&&(o.use(J),o.use(L),o.use(V),t&&(o.use(Ze),o.use(et))),s.markmap&&o.use(ie),s.mermaid&&o.use(me),C(e.playground)){const{presets:a=[],config:l={}}=e.playground;a.forEach(i=>{i==="ts"?o.use(j,Z(l.ts??{})):i==="vue"?o.use(j,ne(l.vue??{})):i==="unocss"?o.use(j,se(l.unocss??{})):C(i)&&o.use(j,i)})}s.kotlinPlayground&&o.use(ae),s.vuePlayground&&o.use(ce),s.sandpack&&o.use(ge)},clientConfigFile:o=>nt(o,e,s,t)}};export{F as CODE_DEMO_DEFAULT_SETTING,z as chartjs,q as echarts,K as flowchart,oe as generateUnoURL,le as getMermaidContent,Z as getTSPlaygroundPreset,X as getURL,se as getUnoPlaygroundPreset,ne as getVuePlaygroundPreset,ae as kotlinPlayground,ie as markmap,ot as mdEnhancePlugin,me as mermaid,J as normalDemo,A as plantuml,j as playground,V as reactDemo,ge as sandpack,L as vueDemo,ce as vuePlayground};
//# sourceMappingURL=index.js.map
